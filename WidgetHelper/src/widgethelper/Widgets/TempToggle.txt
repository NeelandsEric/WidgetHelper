{
  "widget_class": "Digital%20Command%20-%20Toggles%20(feedback)",
  "widget_subclass": "127",
  "w_x": "25",
  "w_y": "593",
  "station": "",
  "io_id": "`%IO_ID%`",
  "code": "<script>\n\t//console.log(\"start of temp button\");\n\tvar global_TempType;\n\t\n\tfunction init(io_id){\n\t\t\n\t\tjQuery.get('/servers/get_value.php?io_id='+io_id, function(data){\n\t\t\t\tchech_auth(data);\t\t\n\t\t\t\tdata=data.split('|');\t\n\t\t\t//console.log(\"set temp type to \"+data[0]);\n\t\t\t\tglobal_TempType = data[0];\n\t\t\t\t\n\t\t\t});\n\t}\n\t\n\tfunction command_toggleunits_feedback(holder, io_id, params) {\n\t\tinit(io_id);\n\t\tvar p={\n\t\t\t\"image\":\"/ui/toggleunits.png\",\n\t\t\t\"width\":\"45\",\n\t\t\t\"height\":\"88\",\n\t\t};\n\t\tjQuery.extend(p,params);\n\t\tcommand_toggle_feedback(holder, io_id, p);\n};\n\t\n\n\t\n\t\n\tfunction command_toggle_feedback(holder, io_id, params) {\n\t\t\n\tvar p={\n\t\t\"holder\" : holder,\n\t\t\"url\" : prepare_url('send_command.php', io_id),\n\n\t\t\"image\":\"\", //este o imagine cu x succesiuni de states ale knobului, pe orizontala, prima fiind knobul inactiv\n\t\t\"width\":\"\",\n\t\t\"height\":\"\",\n\t\t\"toggle_style\":\"\",\n\t\t\"button_style\":\"\",\n\t\t\"button_text\":\"Set!\",\n\t\t\"interval\":5000\n\t};\n\tjQuery.extend(p,params);\n\tif ( !(Number(p.interval)>=5000) ) {\n\t\tp.interval=5000;\n\t}\n\tvar reload_obj=get_reloader_obj(holder);\n\tvar pos=get_reloader_pos(reload_obj);\n\treload_obj[pos]=setInterval(function(){\n\t\tif (typeof(reloadersOverrideFlag)=='undefined' || !reloadersOverrideFlag) update();\n\t},p.interval);\n\n\n\tvar h='<div class=\"toggle\" width=\"'+p.width+'\" style=\"cursor:pointer; display:inline-block; width:'+p.width+'px; height:'+p.height+'px; background-image:url(\\'../'+p.image+'\\'); background-repeat:no-repeat; background-position:0px; '+p.toggle_style+'\">';\n\th+='</div>';\n\t//h+='<input type=\"button\" style=\"display:block; margin-left:auto; margin-right:auto; '+p.button_style+'\" value=\"'+p.button_text+'\" />';\n\tjQuery('#'+holder).html(h);\n\n\tjQuery('#'+holder+' .toggle').click(function() {\n\t\tvar width=Number(jQuery('#'+holder+' .toggle').attr('width'));\n\t\tvar pos=jQuery('#'+holder+' .toggle').css('background-position');\n\t\tpos=Number(pos.replace(/px .*/,''))*(-1);\n\t\tif (pos==0) {\n\t\t\tjQuery('#'+holder+' .toggle').css('background-position',-1*width+'px');\n\t\t\tvar value=1\n\t\t} else {\n\t\t\tjQuery('#'+holder+' .toggle').css('background-position',0+'px');\n\t\t\tvar value=0\n\t\t}\n\n\t\tjQuery.get(p.url+'&feedback&val='+value, function(data){\n\t\t\tchech_auth(data);\n\t\t});\n\t});\n\n\tvar val_update=function(data) {\n\t\tvar width=Number(jQuery('#'+holder+' .toggle').attr('width'));\n\t\tif (data=='0') {\n\t\t\tjQuery('#'+holder+' .toggle').css('background-position',0+'px');\n\t\t} else {\n\t\t\tjQuery('#'+holder+' .toggle').css('background-position',-1*width+'px');\n\t\t}\n\t}\n\n\tvar update=function(){\n\t\tjQuery.get('/servers/get_value.php?io_id='+io_id, function(data){\n\t\t\tchech_auth(data);\n\t\t\tdata=data.split('|');\n\t\t\tglobal_TempType = data[0];\n\t\t\tval_update(data[0]);\n\t\t});\n\t}\n\tupdate();\n\n\tjQuery('#'+holder+' input').dblclick(function() {\n\t\tjQuery('#'+holder+' input').val('...');\n\t\tvar width=Number(jQuery('#'+holder+' .toggle').attr('width'));\n\t\tvar pos=jQuery('#'+holder+' .toggle').css('background-position');\n\t\tpos=Number(pos.replace(/px .*/,''))*(-1);\n\t\tvar value=pos/width;\n\t\tjQuery.get(p.url+'&feedback&val='+value, function(data){\n\t\t\tchech_auth(data);\n\t\t\tvar v=data.match(/\\|(\\d*)$/);\n\t\t\tif (v!=null) {\t\t\t\t\n\t\t\t\tif (v[1]=='0') {\n\t\t\t\t\tjQuery('#'+holder+' .toggle').css('background-position',0+'px');\n\t\t\t\t} else {\n\t\t\t\t\tjQuery('#'+holder+' .toggle').css('background-position',-1*width+'px');\n\t\t\t\t}\n\t\t\t}\n\t\t\t//jQuery('#'+holder+' input').val(data);\n\t\t\tjQuery('#'+holder+' input').val(data.match(/^[^\\|]*/));\n\t\t});\n\t});\n\n\tjQuery('#'+holder+' .toggle').mouseenter(function(){\n\t\t\tjQuery('#'+holder+' input').val(p.button_text);\n\t});\n\tjQuery('#'+holder+' input').mouseenter(function(){\n\t\t\tjQuery('#'+holder+' input').val(p.button_text);\n\t});\n\n};\n</script>\n\n\n<div style=\"/**main_holder**/\">\n\t<div style=\"/**Label**/text-align:center; font-size:14px; font-weight:bold;font-family:Arial;\">\n\t\t<!--*Label*-->Temp<!----><br/>\n\t<div id=\"holder_1449247129\" ></div>\n\t</div>\n</div>\n\n<script>try {\n\n  var io_id=`%IO_ID%`;\n\tvar widget_help={\n\t\t\"main_help\":{\n\t\t\t\"ro\":\"Comutator pentru modificarea valorii unei iesiri\",\n\t\t\t\"en\":\"Toggle button for modifying the value of an input\"\n\t\t}\n\t};\n\tvar editable_params={\n\t\t//\"Label\":\"Label\",\n\t\t//\"button_style\":\"wdith:100%; text-align:center;\"\n\t};\n\tvar params={\n\t\t\"labels\":{\"label\":{\"x\":50, \"y\":50, \"text\":\"Label\", \"attr\":{\"text-anchor\":\"middle\", \"fill\":\"white\", \"font-size\":14, \"font-weight\":\"bold\"}}}\n\t};\n\tparams.button_text=editable_params.ButtonText;\n\t//params.labels.label.text=editable_params.Label;\n  new command_toggleunits_feedback('holder_1449247129', io_id, params);\n\n}catch(e){\n\talert(e);\n}\n</script>"
}