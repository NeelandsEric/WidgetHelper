{
  "widget_class": "Digital%20Value%20-%20Leds",
  "widget_subclass": "150",
  "w_x": "`%XPOS%`",
  "w_y": "`%XPOS%`",
  "station": "",
  "io_id": "`%IO_ID%`",
  "code": "<script>\n\n//=================================================================================\n//======================       Supporting Functions     ===========================\n//=================================================================================\n// JavaScript Document\nvar reloaders = new Array();\n\nfunction stop_all_reloaders(name) {\n\t//name=strign de forma reloaders.panel_content_id_99\n\tvar i=0;\n\tif (typeof(eval(name))!='undefined') {\n\t\tvar reloader_obj=eval(name);\n\t\twhile (reloader_obj.length>0) {\n\t\t\t//clearTimeout(reloader_obj[reloader_obj.length-1]);\n\t\t\tclearInterval(reloader_obj[reloader_obj.length-1]);\n\t\t\treloader_obj.pop();\n\t\t\ti++;\n\t\t}\n\t}\n\treturn i;\n}\n\n\nfunction chech_auth(data) {\n\tif (data=='auth err') {\n\t\twindow.location.href='\\login.php';\n\t}\n}\n\n\nfunction get_gradient_color(color) {\n\tswitch(color)\n\t{\n\t/*case 'red':\n\t\treturn \"#F00-#500\";\n\t\tbreak;\n\tcase 'green':\n\t\treturn \"#0F0-#050\";\n\t\tbreak;\n\tcase 'blue':\n\t\treturn \"#ACF-#00C\";\n\t\tbreak;\n\tcase 'amber':\n\t\treturn \"#FE0-#440\";\n\t\tbreak;\n\tcase 'grey':\n\t\treturn \"#FFF-#555\";\n\t\tbreak;*/\n\tcase 'rosu':\n\tcase 'red':\n\t\treturn \"#F00-#500\";\n\t\tbreak;\n\tcase 'verde':\n\tcase 'green':\n\t\treturn \"#0F0-#050\";\n\t\tbreak;\n\tcase 'albastru':\n\tcase 'blue':\n\t\treturn \"#ACF-#00C\";\n\t\tbreak;\n\tcase 'chihlimbar':\n\tcase 'amber':\n\t\treturn \"#FE0-#440\";\n\t\tbreak;\n\tcase 'gri':\n\tcase 'grey':\n\t\treturn \"#FFF-#555\";\n\t\tbreak;\n\tcase 'turcoaz':\n\tcase 'turquoise':\n\tcase 'cyan':\n\tcase 'aqua':\n\tcase 'teal':\n\tcase 'aquamarine':\n\t\treturn \"#0FF-#055\";\n\t\tbreak;\n\tcase 'violet':\n\tcase 'purple':\n\tcase 'magenta':\n\tcase 'fuchsia':\n\t\treturn \"#F0F-#505\";\n\t\tbreak;\n\tcase 'galben':\n\tcase 'yellow':\n\t\treturn \"#FF0-#550\";\n\t\tbreak;\n\tcase 'orange':\n\tcase 'oranj':\n\tcase 'portocaliu':\n\t\treturn \"#F80-#FC9\";\n\t\tbreak;\n\tcase 'pink':\n\tcase 'roz':\n\t\treturn \"#F08-#F9C\";\n\t\tbreak;\n\tdefault:\n\t\treturn color; //gray\n\t}\n}\n\nfunction string_to_date(the_string,the_date) {\n\tvar the_str=the_string;\n\tvar the_dat=new Date(the_date*1000);\n\t//the_str=the_str.replace(\"D\",the_dat.getDate());\n\tthe_str=the_str.replace(\"D\",(\"0\"+the_dat.getDate()).slice(-2))\n\t//the_str=the_str.replace(\"M\",(the_dat.getMonth()+1));\n\tthe_str=the_str.replace(\"M\",(\"0\"+(the_dat.getMonth()+1)).slice(-2));\n\tthe_str=the_str.replace(\"Y\",the_dat.getFullYear());\n\tthe_str=the_str.replace(\"h\",(\"0\"+the_dat.getHours()).slice(-2));\n\tthe_str=the_str.replace(\"m\",(\"0\"+the_dat.getMinutes()).slice(-2));\n\tthe_str=the_str.replace(\"s\",(\"0\"+the_dat.getSeconds()).slice(-2));\n\tthe_str=the_str.replace(\"|\",\"\\n\");\n\treturn(the_str);\n}\n\nfunction prepare_url(url,io_id) {\n\t//poate fi apelat cu server=xxx si io_id=0 sau\n\t//cu server=xxx.php?io_id=0&xx=yy si io_id='' sau\n\t//cu server=xxx.php?xx=yy si io_id=0 sau\n\n\tif (url.indexOf('.php')==-1)\n\t\turl+='.php';\n\turl='/servers/'+url;\n\tif (String(io_id)!='') {\n\t\tif (url.indexOf('?')==-1)\n\t\t\t//nu are '?'\n\t\t\turl+='?';\n\t\telse\n\t\t\t//are '?'\n\t\t\turl+='&';\n\t\turl+='io_id='+io_id;\n\t}\n\treturn url;\n}\n\nfunction helpme_get_value(io_id, success_function) {\n\tjQuery.get( prepare_url('get_value',io_id), function(data){success_function(data);} );\n}\n\n\t\n\t\n//=================================================================================\n//=============================    WIDGET: led   ==================================\n//=================================================================================\nfunction led(holder,url,val_source,params) {\n\t//primeste date in forma value|um|error=0,1\n\tvar p={\n\t\t\"holder\" : holder,\n\t\t\"url\" : val_source,\n\t\t\"interval\":2000,\n\t\t\"color_on\" : \"#0F0-#050\",\n\t\t\"color_off\" : \"#FFF-#555\",\n\t\t\"color_err\" : \"#F00-#500\",\n\t\t\"color_cau\" : \"#FF0-#550\",\n\t\t\"width\":20,\n\t\t\"height\":20,\n\t\t\"light_width\":20,\n\t\t\"light_height\":20\n\t};\n\tjQuery.extend(p,params);\n\tif ( !(Number(p.interval)>=2000) ) {\n\t\tp.interval=2000;\n\t}\n\tvar ledul = Raphael(p.holder, p.width, p.height);\n\tvar circle=ledul.ellipse(p.width/2, p.height/2, p.light_width/2, p.light_height/2);\n\tcircle.attr(\"stroke-width\",0);\n\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_on));\n\tvar reload_obj=get_reloader_obj(holder);\n\tvar pos=get_reloader_pos(reload_obj);\n\treload_obj[pos]=setInterval(function(){\n\t\tif (typeof(reloadersOverrideFlag)=='undefined' || !reloadersOverrideFlag) update();\n\t},p.interval);\n\n\tvar val_update=function(data){\n\t\t\tdata=data.split('|');\n\t\t\tif (data[2]==1) {\n\t\t\t\t//error\n\t\t\t\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_cau));\n\t\t\t\t//alertStatus[pos]=true;\n\t\t\t} else {\n\t\t\t\t//alertStatus[pos]=false;\n\t\t\t\tif (data[0]==0) {\n\t\t\t\t\t//off\n\t\t\t\t\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_off));\n\t\t\t\t} else if(data[0] >= 1 && data[0] < 4){\n\t\t\t\t\t//On - Or moving towards error\n\t\t\t\t\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_on));\n\t\t\t\t}else if(data[0] >= 4){\n\t\t\t\t\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_err));\t\t\t\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\t// error\n\t\t\t\t\tcircle.attr(\"fill\", \"r(0.4, 0.4)\"+get_gradient_color(p.color_cau));\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t}\n\t\t\t//reload_obj[pos]=setTimeout(function(){update();},p.interval);\n\t}\n\tvar update=function(){\n\t\tif (typeof(val_source)=='number') {\n\t\t\tp.url= prepare_url(url,val_source);\n\t\t\tjQuery.get(p.url, function(data){\n\t\t\t\tchech_auth(data);\n\t\t\t\tval_update(data);\n\t\t\t});\n\t\t} else if (typeof(val_source)=='function') {\n\t\t\tval_source(val_update); //pasam functiei custom ca parametru functia noastra de update\n\t\t}\n\t}\n\tupdate();\n};\n\t\n\t\n</script>\n<div style=\"/**main_holder**/padding:5px;\">\n    <span id=\"holder_1455117810\" style=\"text-align:center; display:inline-block;\"></span>\n    <span style=\"/**Label**/padding-left:5px; font-size:14px; font-family:Arial;\">\n        <!--*Label*-->\n        <!---->\n    </span>\n</div>\n<script>try {\n\n  var server='get_value';\n  var io_id=`%IO_ID%`;\n\tvar val_source=io_id;\n\tvar widget_help={\n\t\t\"main_help\":{\n\t\t\t\"en\":\"Display a digital input's value.\",\n\t\t\t\"ro\":\"Afișează valoarea unei intrări digitale.\"\n\t\t},\n\t\t\"OnColor\":{\n\t\t\t\"en\":\"The color of the LED when the input's value is 1. The colour's name should be written here!\",\n\t\t\t\"ro\":\"Culoarea LED-ului când intrarea este pe 1.  Scrieti aici numele culorii!\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"OffColor\":{\n\t\t\t\"en\":\"The color of the LED when the input's value is 0. The colour's name should be written here!\",\n\t\t\t\"ro\":\"Culoarea LED-ului când intrarea este pe 0. Scrieti aici numele culorii!\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"ErrColor\":{\n\t\t\t\"en\":\"The color of the LED when there's an error. The colour's name should be written here!\",\n\t\t\t\"ro\":\"Culoarea LED-ului când apare o eroare. Scrieti aici numele culorii!\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"CauColor\":{\n\t\t\t\"en\":\"The color of the LED when there's an caution. The colour's name should be written here!\",\n\t\t\t\"ro\":\"Culoarea LED-ului când apare o caution. Scrieti aici numele culorii!\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"LEDHeight\":{\n\t\t\t\"en\":\"The LED's height, measured in pixels.\",\n\t\t\t\"ro\":\"Înălțimea LED-ului, măsurată în pixeli.\",\n\t\t\t\"width\":\"30px\"\n\t\t},\n\t\t\"LEDWidth\":{\n\t\t\t\"en\":\"The LED's width, measured in pixels.\",\n\t\t\t\"ro\":\"Lățimea LED-ului, măsurată în pixeli.\",\n\t\t\t\"width\":\"30px\"\n\t\t}\n\t};\n\n\tvar editable_params={\n\t\t\"OnColor\":\"green\",\n\t\t\"OffColor\":\"grey\",\n\t\t\"ErrColor\":\"red\",\n\t\t\"CauColor\":\"yellow\",\n\t\t\"LEDHeight\":25,\n\t\t\"LEDWidth\":25};\n  var params={\n    \"color_on\":\"green\",\n    \"color_off\":\"grey\",\n    \"color_err\":\"red\",\n\t\t\"color_cau\":\"yellow\",\n    \"width\":20,\n    \"height\":20,\n    \"light_width\":20,\n    \"light_height\":20,\n\t\t\"interval\":5000};\n\tparams.color_on=editable_params.OnColor;\n\tparams.color_off=editable_params.OffColor;\n\tparams.color_err=editable_params.ErrColor;\n\tparams.color_cau=editable_params.CauColor;\n\tparams.width=editable_params.LEDWidth;\n\tparams.height=editable_params.LEDHeight;\n\tparams.light_width=Math.round((editable_params.LEDWidth * 18) / 18);\n\tparams.light_height=Math.round((editable_params.LEDHeight * 18) / 18);\n\tnew led('holder_1455117810', server, val_source, params);\n\n}catch(e){\n\talert(e);\n}\n</script>"
}