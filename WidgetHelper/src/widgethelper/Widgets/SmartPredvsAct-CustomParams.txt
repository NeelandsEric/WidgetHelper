{
  "widget_class": "Universal%20Value%20-%20Text",
  "widget_subclass": "181",
  "w_x": "`%XPOS%`",
  "w_y": "`%YPOS%`",
  "code": "<script>\n\n//=================================================================================\n//=============================    WIDGET: smartPredVsAct   =======================\n//=================================================================================\nfunction smartPredVsAct(holder,url,io_ids,params) {\n\t\n\tvar data1 = 0, data2 = 0, uom1 = \"\", uom2 = \"\";\n\tvar p={\n\t\t\"holder\" : holder,\n\t\t\"url\" : io_ids[0],\n\t\t\"url2\": io_ids[1],\t\t\n\t\t\"value_span_style\":\"\"\t\t\n\t};\n\tjQuery.extend(p,params);\n\n\tvar val_update=function(data, point){\n\t\t\n\t\t//console.log(\"Data: \" + data);\n\t\t\tdata = data.split(\"|\");\n\t\t\tif(point == 1){\n\t\t\t\t// Check the data \n\t\t\t\tif(data[1] != \"unkonwn_ioid\"){\n\t\t\t\t\tuom1 = data[1];\n\t\t\t\t\tdata1 = Math.round(data[0] * 100) / 100;\t\t\t\t\t\t\t\t\t\n\t\t\t\t}\t\t\t\t\n\t\t\t}else if(point == 2){\t\t\t\t\n\t\t\t\t// Check the data \n\t\t\t\tif(data[1] != \"unkonwn_ioid\"){\n\t\t\t\t\tuom2 = data[1];\n\t\t\t\t\tdata2 = Math.round(data[0] * 100) / 100;\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\n\t\t\t\n\t\t\t//console.log(\"Data1: \" + data1 + uom1);\n\t\t\t//console.log(\"Data2: \" + data2 + uom2);\n\t\t\t\n\t\t\tvar percentage = p.percentage;\n\t\t\tif(p.percentage > 0.75){\n\t\t\t\tpercentage = p.percentage / 100;\n\t\t\t}\n\t\t\t\n\t\t\tvar textColor;\n\t\t\tvar diff = 0;\n\t\t\t\n\t\t\t// Actual - Predicted\n\t\t\tdiff = Math.round(data2 - data1);\n\t\t\t\n\t\t\tif(diff <= 0){\n\t\t\t\ttextColor = p.goodColor;\n\t\t\t}else {\n\t\t\t\tvar diffFactor = diff / data1;\n\t\t\t\t\n\t\t\t\tif(diffFactor > percentage){\n\t\t\t\t\ttextColor = p.badColor;\n\t\t\t\t}else if(diffFactor > (percentage/2)){\n\t\t\t\t\ttextColor = p.avgColor;\n\t\t\t\t}else {\n\t\t\t\t\t//textColor = p.goodColor;\n\t\t\t\t\ttextColor = p.color;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar dataString = [];\t\t\t\n\t\t\tif(uom1 == \"$\" || uom2 == \"$\"){\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tdataString[0] = \"$\" + data1;\t\t\t\t\t\t\t\t\t\n\t\t\t\tdataString[1] = \"$\" + data2;\t\t\t\t\t\t\n\t\t\t\tdataString[2] = \"$\" + diff;\n\t\t\t\t\n\t\t\t\tif(uom1.indexOf(\"$\") > -1 || uom2.indexOf(\"$\") > -1){\n\t\t\t\t\t\n\t\t\t\t\tdataString[0] += uom1.substring(uom1.indexOf(\"$\") + 1);\n\t\t\t\t\tdataString[1] += uom2.substring(uom2.indexOf(\"$\") + 1);\n\t\t\t\t\tdataString[2] += uom1.substring(uom1.indexOf(\"$\") + 1);\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t}else if(!(!uom1 || /^\\s*$/.test(uom1))){\n\t\t\t\tdataString[0] = data1 + uom1;\t\t\t\t\t\t\t\t\t\n\t\t\t\tdataString[1] = data2 + uom1;\t\t\t\t\t\t\n\t\t\t\tdataString[2] = diff + uom1;\n\t\t\t\t\t\n\t\t\t}else {\n\t\t\t\tdataString[0] = data1;\t\t\t\t\t\t\t\t\t\n\t\t\t\tdataString[1] = data2;\t\t\t\t\t\t\n\t\t\t\tdataString[2] = diff;\n\t\t\t}\n\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t//main span\n\t\t\th='<span style=\"'+p.value_span_style+p.color+'\">';\t\t\t\n\t\t\th+= dataString[0] + '</br></span>';\t\t\t\n\t\t\th+='<span style=\"'+p.value_span_style+textColor+'\">';\t\t\n\t\t\th+= dataString[1] + '</br></span>';\n\t\t\th+='<span style=\"'+p.value_span_style+p.color+'\">';\t\t\t\n\t\t\th+= dataString[2]+ '</span>';\n\t\t\t\t\n\t\t\tjQuery('#'+p.holder).html(h);\n\t}\n\tif(io_ids[0] != null){\n\t\tattachLiveUpdater(io_ids[0], function(data){\n\t\t\tval_update(data, 1);\n\t\t});\n\t}\n\tif(io_ids[1] != null){\n\t\tattachLiveUpdater(io_ids[1], function(data){\n\t\t\tval_update(data, 2);\n\t\t});\n\t}\n};\n\nfunction isNumber(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n};\n\n</script>\n\n<span id=\"holder_1458325624252\"></span>\n<script language=\"javascript\" type=\"text/javascript\">\n//=================================================================================\n//======================       Regular Widget Setup     ===========================\n//=================================================================================\n\n\tvar server='get_value';\n\tvar io_ids=[`%IO_ID%`,`%IO_ID2%`];\n\tvar widget_help={\n\t\t\"main_help\":{\n\t\t\t\"ro\":\"Text pentru afișarea unei valori\",\n\t\t\t\"en\":\"Text for displaying a value\"\n\t\t},\n\t\t\"Font\":{\n\t\t\t\"ro\":\"Fontul textului<br/>&nbsp;Arial<br/>&nbsp;Lucida Sans Unicode<br/>&nbsp;Verdana\",\n\t\t\t\"en\":\"Text font<br/>&nbsp;Arial<br/>&nbsp;Lucida Sans Unicode<br/>&nbsp;Verdana\"\n\t\t},\n\t\t\"FontSize\":{\n\t\t\t\"ro\":\"Dimensiunea textului\",\n\t\t\t\"en\":\"Text size\",\n\t\t\t\"width\":\"30px\"\n\t\t},\n\t\t\"Spacing\":{\n\t\t\t\"ro\":\"\",\n\t\t\t\"en\":\"Space between the lines\",\n\t\t\t\"width\":\"25px\"\n\t\t},\n\t\t\"Percentage\":{\n\t\t\t\"ro\":\"\",\n\t\t\t\"en\":\"Percentage of the difference\",\n\t\t\t\"width\":\"25px\"\n\t\t},\n\t\t\"Color\":{\n\t\t\t\"ro\":\"Culoarea textului când citește o valoare validă\",\n\t\t\t\"en\":\"The text color when it is within the smallest percentage\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"AvgColor\":{\n\t\t\t\"ro\":\"\",\n\t\t\t\"en\":\"The text color when it is within the 2nd smallest percentage\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"GoodColor\":{\n\t\t\t\"ro\":\"\",\n\t\t\t\"en\":\"The text color when it is within the smallest percentage\",\n\t\t\t\"width\":\"60px\"\n\t\t},\n\t\t\"BadColor\":{\n\t\t\t\"ro\":\"Culoarea textului când apare o eroare\",\n\t\t\t\"en\":\"The text color when it is greater than the percentage\",\n\t\t\t\"width\":\"60px\"\n\t\t}\n\t\t\t\t\n\t};\n\t\n\tvar color_pickers='Color,AvgColor,GoodColor,BadColor';\n\tvar editable_params={\t\t\n\t\t\"Font\":\"Arial\",\n\t\t\"FontSize\":\"`%FONTSIZE%`\",\n\t\t\"Spacing\":\"`%SPACE%`\",\n\t\t\"Percentage\":\"`%PERCENTAGE%`\",\n\t\t\"Color\":\"#ffffff\",\n\t\t\"AvgColor\":\"#fff000\",\n\t\t\"GoodColor\":\"#00ff00\",\n\t\t\"BadColor\":\"#ff0000\"\t\t\n\t};\n\t\n\tvar params={    \n\t\t\"value_span_style\":\"font-weight:normal;\",\t\t//styling of the value text  \n\t\t\"percentage\":0.25,\n\t\t\"spacing\":1.85};\t\n\t\n\tparams.value_span_style+=\"font-family:\"+editable_params.Font+\";\";\n\tparams.value_span_style+=\"font-size:\"+editable_params.FontSize+\"px;\";\n\tparams.value_span_style+=\"color:\"+editable_params.Color+\";\";\n\tparams.value_span_style+=\"line-height:\"+editable_params.Spacing+\";\";\t\n\tparams.color=\"color:\"+editable_params.Color+\";\";\n\tparams.avgColor=\"color:\"+editable_params.AvgColor+\";\";\n\tparams.goodColor=\"color:\"+editable_params.GoodColor+\";\";\n\tparams.badColor=\"color:\"+editable_params.BadColor+\";\";\n\tparams.percentage=editable_params.Percentage;\n  \n\tnew smartPredVsAct('holder_1458325624252', server, io_ids, params);\n</script>"
}